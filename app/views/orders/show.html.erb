<!-- FILE: app/views/orders/show.html.erb -->

<div class="container py-5">

  <!-- HEADER -->
  <div class="mb-4">
    <h2 class="font-weight-bold">Order Confirmation</h2>
    <p class="text-muted">Order #<%= @order.id %></p>
  </div>

  <div class="row">

    <!-- ORDER DETAILS -->
    <div class="col-lg-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-bottom">
          <h5 class="mb-0 font-weight-bold">Order Items</h5>
        </div>

        <ul class="list-group list-group-flush">
          <% @order.order_items.each do |item| %>
            <% line_price = item.price_at_purchase || item.price || 0 %>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong><%= item.product_name %></strong><br>
                <small class="text-muted">Qty: <%= item.quantity %></small>
              </div>
              <span class="font-weight-bold">
                $<%= number_with_precision(line_price * item.quantity, precision: 2) %>
              </span>
            </li>
          <% end %>
        </ul>
      </div>
    </div>

    <!-- SUMMARY -->
    <div class="col-lg-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-bottom">
          <h5 class="mb-0 font-weight-bold">Payment Summary</h5>
        </div>

        <div class="card-body">

          <div class="d-flex justify-content-between mb-2">
            <span>Subtotal</span>
            <strong>$<%= number_with_precision(@order.subtotal, precision: 2) %></strong>
          </div>

          <div class="d-flex justify-content-between mb-2">
            <span>GST</span>
            <strong>$<%= number_with_precision(@order.gst, precision: 2) %></strong>
          </div>

          <div class="d-flex justify-content-between mb-2">
            <span>PST</span>
            <strong>$<%= number_with_precision(@order.pst, precision: 2) %></strong>
          </div>

          <div class="d-flex justify-content-between mb-3">
            <span>HST</span>
            <strong>$<%= number_with_precision(@order.hst, precision: 2) %></strong>
          </div>

          <hr>

          <div class="d-flex justify-content-between">
            <h4 class="font-weight-bold">Total</h4>
            <h4 class="font-weight-bold text-primary">
              $<%= number_with_precision(@order.total, precision: 2) %>
            </h4>
          </div>
        </div>
      </div>

      <!-- Back to store -->
      <div class="mt-4">
        <%= link_to "Back to Store", products_path, class: "btn btn-outline-secondary btn-lg w-100" %>
      </div>
    </div>

  </div>

</div>
